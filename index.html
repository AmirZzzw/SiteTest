<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فروشگاه خدمات دیجیتال | SidkaShop</title>
    
    <!-- استایل‌ها -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="#">
    
    <!-- بارگذاری ماژول‌ها -->
    <script type="module">
        // بارگذاری توابع Supabase
        import { loginOrRegisterUser, getAllProducts, createNewOrder, 
                 getUserOrders, getAllOrders, updateOrderStatus, 
                 createNewTicket, getUserTickets, getAllTickets, 
                 addTicketReply, updateTicketStatus, getDashboardStats,
                 updateUserInfo } from './supabase-service.js';
        
        // ایجاد آبجکت global برای دسترسی از main.js
        window.supabaseFunctions = {
            loginOrRegisterUser,
            getAllProducts,
            createNewOrder,
            getUserOrders,
            getAllOrders,
            updateOrderStatus,
            createNewTicket,
            getUserTickets,
            getAllTickets,
            addTicketReply,
            updateTicketStatus,
            getDashboardStats,
            updateUserInfo
        };
        
        // بارگذاری منطق اصلی برنامه
        import { initializeApp } from './main.js';
        
        // اجرای برنامه پس از بارگذاری DOM
        window.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</head>
<body>
    <!-- هدر سایت -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">
                    <i class="fas fa-store"></i>
                    <span>SidkaShop</span>
                </a>
                
                <ul class="nav-links">
                    <li><a href="#home" class="active"><i class="fas fa-home"></i> خانه</a></li>
                    <li><a href="#products"><i class="fas fa-box"></i> محصولات</a></li>
                    <li><a href="#pricing"><i class="fas fa-tag"></i> لیست قیمت</a></li>
                    
                    <!-- پشتیبانی -->
                    <li class="support-ticket-link">
                        <a href="#ticket" id="ticket-btn">
                            <i class="fas fa-comment-dots"></i> پشتیبانی
                        </a>
                    </li>
                    
                    <!-- سبد خرید -->
                    <li class="cart-icon">
                        <a href="#cart" id="cart-toggle">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-count">0</span>
                        </a>
                    </li>
                    
                    <!-- بخش کاربر -->
                    <li class="user-section">
                        <a href="#login" id="login-btn"><i class="fas fa-user"></i> ورود</a>
                        <div class="user-dropdown" id="user-dropdown">
                            <a href="#profile" id="profile-btn"><i class="fas fa-user-circle"></i> پروفایل</a>
                            <a href="#orders" id="orders-btn"><i class="fas fa-history"></i> سابقه خرید</a>
                            <a href="#mytickets" id="mytickets-btn"><i class="fas fa-ticket-alt"></i> تیکت‌های من</a>
                            <a href="#logout" id="logout-btn"><i class="fas fa-sign-out-alt"></i> خروج</a>
                        </div>
                    </li>
                    
                    <!-- ادمین -->
                    <li class="admin-link" id="admin-nav-item" style="display: none;">
                        <a href="#admin" id="admin-btn"><i class="fas fa-cogs"></i> پنل ادمین</a>
                    </li>
                </ul>
                
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- صفحه اصلی -->
    <main>
        <!-- بخش معرفی -->
        <section class="hero" id="home">
            <div class="container">
                <div class="hero-content">
                    <h1>فروشگاه خدمات دیجیتال</h1>
                    <p class="subtitle">ارائه با کیفیت‌ترین خدمات دیجیتال با قیمت مناسب</p>
                    <p>خرید پنل، اشتراک VPN، طراحی تامنیل و خدمات مرتبط با امنیت کامل و پشتیبانی 24 ساعته</p>
                    <div class="hero-buttons">
                        <a href="#products" class="btn btn-primary">مشاهده محصولات</a>
                        <a href="#pricing" class="btn btn-secondary">لیست قیمت</a>
                        <a href="#ticket" class="btn btn-telegram" id="open-ticket-main">
                            <i class="fas fa-comment-medical"></i> پشتیبانی
                        </a>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-laptop-code"></i>
                </div>
            </div>
        </section>

        <!-- بخش محصولات -->
        <section class="products" id="products">
            <div class="container">
                <h2 class="section-title">محصولات و خدمات</h2>
                <p class="section-subtitle">خدمات دیجیتال با کیفیت بالا و قیمت مناسب</p>
                
                <div class="product-filters">
                    <button class="filter-btn active" data-filter="all">همه</button>
                    <button class="filter-btn" data-filter="panels">پنل‌ها</button>
                    <button class="filter-btn" data-filter="subscriptions">اشتراک‌ها</button>
                    <button class="filter-btn" data-filter="design">خدمات طراحی</button>
                </div>
                
                <div class="products-grid" id="products-grid">
                    <!-- محصولات از طریق JavaScript اضافه می‌شوند -->
                    <div class="loading-products">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>در حال بارگذاری محصولات...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- بخش لیست قیمت -->
        <section class="pricing" id="pricing">
            <div class="container">
                <h2 class="section-title">لیست قیمت خدمات</h2>
                <p class="section-subtitle">قیمت‌های شفاف و بدون واسطه</p>
                
                <div class="pricing-table">
                    <table>
                        <thead>
                            <tr>
                                <th>نام خدمت</th>
                                <th>توضیحات</th>
                                <th>قیمت (تومان)</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="pricing-table-body">
                            <!-- ردیف‌های جدول از طریق JavaScript اضافه می‌شوند -->
                            <tr>
                                <td colspan="4" style="text-align: center; padding: 30px;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    در حال بارگذاری...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- اطلاعات پرداخت -->
                <div class="payment-info">
                    <h3><i class="fas fa-credit-card"></i> روش پرداخت</h3>
                    <div class="payment-card">
                        <div class="payment-details">
                            <p><strong>مبلغ را به شماره کارت زیر واریز کنید:</strong></p>
                            <div class="card-number">
                                <i class="fas fa-credit-card"></i>
                                <span id="card-number-text">6037 9982 227 6759</span>
                                <button class="copy-btn" onclick="window.copyToClipboard('603799822276759')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                            <p><strong>به نام:</strong> امیرمحمد یوسفی</p>
                            <p class="note">پس از واریز، رسید را در صفحه پرداخت آپلود کنید.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- بخش تماس -->
        <section class="contact" id="contact">
            <div class="container">
                <h2 class="section-title">تماس با ما</h2>
                <p class="section-subtitle">راه‌های ارتباطی با پشتیبانی</p>
                
                <div class="contact-content">
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fab fa-telegram"></i>
                            <h3>پشتیبانی تلگرام</h3>
                            <p>@SidkaSupport</p>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <h3>تماس تلفنی</h3>
                            <p id="admin-phone-text">09021707830</p>
                            <button class="btn btn-primary" onclick="window.copyToClipboard('09021707830')">کپی شماره</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- فوتر -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <a href="#" class="logo">
                        <i class="fas fa-store"></i>
                        <span>SidkaShop</span>
                    </a>
                    <p>فروشگاه خدمات دیجیتال با امنیت و کیفیت بالا</p>
                </div>
                
                <div class="footer-copyright">
                    <p>تمامی حقوق برای فروشگاه خدمات دیجیتال محفوظ است © ۱۴۰۳</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- ========== MODALS ========== -->
    
    <!-- سبد خرید -->
    <div class="cart-overlay" id="cart-overlay"></div>
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-cart"></i> سبد خرید</h3>
            <button class="close-cart" id="close-cart">&times;</button>
        </div>
        
        <div class="cart-items" id="cart-items">
            <!-- آیتم‌های سبد خرید -->
            <div class="empty-cart">
                <i class="fas fa-shopping-cart"></i>
                <p>سبد خرید شما خالی است</p>
            </div>
        </div>
        
        <div class="cart-footer">
            <div class="cart-total">
                <span>مجموع:</span>
                <span id="cart-total-price">۰ تومان</span>
            </div>
            <button class="btn btn-primary btn-checkout" id="checkout-btn">ادامه فرآیند خرید</button>
        </div>
    </div>

    <!-- مودال ورود/عضویت -->
    <div class="modal-overlay" id="login-overlay"></div>
    <div class="modal" id="login-modal">
        <div class="modal-header">
            <h3>ورود / عضویت</h3>
            <button class="close-modal" id="close-login">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="login-form">
                <div class="form-group">
                    <label for="phone">شماره موبایل</label>
                    <input type="text" id="phone" placeholder="09xxxxxxxxx" maxlength="11">
                </div>
                <button class="btn btn-primary btn-login" id="submit-login">ورود / عضویت</button>
            </div>
        </div>
    </div>

    <!-- مودال پرداخت -->
    <div class="modal-overlay" id="checkout-overlay"></div>
    <div class="modal modal-lg" id="checkout-modal">
        <div class="modal-header">
            <h3><i class="fas fa-credit-card"></i> تکمیل خرید و پرداخت</h3>
            <button class="close-modal" id="close-checkout">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="checkout-form">
                <h4>اطلاعات شخصی</h4>
                <div class="form-group">
                    <label for="first-name">نام *</label>
                    <input type="text" id="first-name" placeholder="نام خود را وارد کنید">
                </div>
                <div class="form-group">
                    <label for="last-name">نام خانوادگی *</label>
                    <input type="text" id="last-name" placeholder="نام خانوادگی خود را وارد کنید">
                </div>
                <div class="form-group">
                    <label for="checkout-phone">شماره موبایل *</label>
                    <input type="text" id="checkout-phone" placeholder="09xxxxxxxxx" maxlength="11">
                </div>
                
                <div class="order-summary">
                    <h4>خلاصه سفارش</h4>
                    <div id="order-summary-items">
                        <!-- آیتم‌های سفارش -->
                    </div>
                    <div class="order-total">
                        <span>مجموع:</span>
                        <span id="order-total-price">۰ تومان</span>
                    </div>
                </div>
                
                <div class="payment-instruction">
                    <h4>روش پرداخت</h4>
                    <p><strong>لطفاً مبلغ <span id="payment-amount">۰</span> تومان را به شماره کارت زیر واریز کنید:</strong></p>
                    <div class="card-number-large">
                        <i class="fas fa-credit-card"></i>
                        <span>6037 9982 227 6759</span>
                        <button class="copy-btn" onclick="window.copyToClipboard('603799822276759')">
                            <i class="fas fa-copy"></i> کپی
                        </button>
                    </div>
                    <p><strong>به نام:</strong> امیرمحمد یوسفی</p>
                </div>
                
                <div class="upload-receipt">
                    <h4>آپلود رسید پرداخت</h4>
                    <div class="form-group">
                        <label>رسید پرداخت (تصویر) *</label>
                        <input type="file" id="receipt-file" accept="image/*,.jpg,.jpeg,.png">
                        <p class="note">فرمت‌های مجاز: JPG, JPEG, PNG (حداکثر 5MB)</p>
                    </div>
                    <div class="form-group">
                        <label for="receipt-note">توضیحات (اختیاری)</label>
                        <textarea id="receipt-note" rows="2" placeholder="مثلاً ساعت واریز، شماره پیگیری و ..."></textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" id="final-submit-btn">تکمیل خرید و ارسال</button>
            </div>
        </div>
    </div>

    <!-- مودال تیکت پشتیبانی -->
    <div class="modal-overlay" id="ticket-overlay"></div>
    <div class="modal modal-lg" id="ticket-modal">
        <div class="modal-header">
            <h3><i class="fas fa-comment-medical"></i> سیستم پشتیبانی</h3>
            <button class="close-modal" id="close-ticket">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="ticket-form">
                <h4>ارسال تیکت جدید</h4>
                <div class="form-group">
                    <label for="ticket-subject">موضوع *</label>
                    <input type="text" id="ticket-subject" placeholder="مشکل در خرید، سوال درباره محصول و ...">
                </div>
                <div class="form-group">
                    <label for="ticket-message">پیام *</label>
                    <textarea id="ticket-message" rows="5" placeholder="پیام خود را با جزئیات بنویسید..."></textarea>
                </div>
                <button class="btn btn-primary" id="submit-ticket-btn">ارسال تیکت</button>
            </div>
        </div>
    </div>

    <!-- مودال سابقه خرید -->
    <div class="modal-overlay" id="orders-overlay"></div>
    <div class="modal modal-lg" id="orders-modal">
        <div class="modal-header">
            <h3>سابقه خرید</h3>
            <button class="close-modal" id="close-orders">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="orders-list" id="orders-list">
                <!-- سفارش‌ها -->
                <div class="empty-orders">
                    <i class="fas fa-history"></i>
                    <p>هنوز سفارشی ثبت نکرده‌اید</p>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال پروفایل -->
    <div class="modal-overlay" id="profile-overlay"></div>
    <div class="modal" id="profile-modal">
        <div class="modal-header">
            <h3>پروفایل کاربری</h3>
            <button class="close-modal" id="close-profile">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="profile-info">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-details">
                    <div class="profile-item">
                        <span>نام:</span>
                        <span id="profile-name">---</span>
                    </div>
                    <div class="profile-item">
                        <span>نام خانوادگی:</span>
                        <span id="profile-lastname">---</span>
                    </div>
                    <div class="profile-item">
                        <span>شماره موبایل:</span>
                        <span id="profile-phone">---</span>
                    </div>
                    <div class="profile-item">
                        <span>تعداد سفارشات:</span>
                        <span id="profile-orders-count">۰</span>
                    </div>
                    <div class="profile-item">
                        <span>تعداد تیکت‌ها:</span>
                        <span id="profile-tickets-count">۰</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال تیکت‌های من -->
    <div class="modal-overlay" id="mytickets-overlay"></div>
    <div class="modal modal-lg" id="mytickets-modal">
        <div class="modal-header">
            <h3><i class="fas fa-ticket-alt"></i> تیکت‌های من</h3>
            <button class="close-modal" id="close-mytickets">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="user-tickets-list" id="user-tickets-list">
                <!-- تیکت‌های کاربر -->
                <div class="empty-message">
                    <i class="fas fa-ticket-alt"></i>
                    <p>هنوز تیکتی ارسال نکرده‌اید</p>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال پنل ادمین -->
    <div class="modal-overlay" id="admin-overlay"></div>
    <div class="modal modal-xl" id="admin-modal">
        <div class="modal-header">
            <h3><i class="fas fa-cogs"></i> پنل مدیریت ادمین</h3>
            <button class="close-modal" id="close-admin">&times;</button>
        </div>
        
        <div class="modal-body">
            <!-- اطلاعات ادمین -->
            <div class="admin-info">
                <h4>اطلاعات ادمین</h4>
                <p><strong>نام:</strong> امیرمحمد یوسفی</p>
                <p><strong>شماره تماس:</strong> 09021707830</p>
                <p><strong>شماره کارت:</strong> 6037-9982-227-6759</p>
            </div>
            
            <!-- آمار کلی -->
            <div class="admin-stats">
                <div class="stat-card">
                    <h5>کاربران</h5>
                    <span id="stats-users-count">0</span>
                </div>
                <div class="stat-card">
                    <h5>سفارشات</h5>
                    <span id="stats-orders-count">0</span>
                </div>
                <div class="stat-card">
                    <h5>درآمد کل</h5>
                    <span id="stats-total-income">0 تومان</span>
                </div>
                <div class="stat-card">
                    <h5>تیکت‌های جدید</h5>
                    <span id="stats-new-tickets">0</span>
                </div>
            </div>
            
            <!-- تب‌های ادمین -->
            <div class="admin-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="orders-tab">سفارشات</button>
                    <button class="tab-btn" data-tab="tickets-tab">تیکت‌ها</button>
                    <button class="tab-btn" data-tab="users-tab">کاربران</button>
                </div>
                
                <!-- تب سفارشات -->
                <div class="tab-content active" id="orders-tab">
                    <div class="admin-section">
                        <h4>مدیریت سفارشات</h4>
                        <div class="admin-orders-list" id="admin-orders-list">
                            <!-- لیست سفارشات -->
                            <div class="empty-message">
                                <i class="fas fa-box-open"></i>
                                <p>هنوز سفارشی ثبت نشده است</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تب تیکت‌ها -->
                <div class="tab-content" id="tickets-tab">
                    <div class="admin-section">
                        <h4>مدیریت تیکت‌های پشتیبانی</h4>
                        <div class="admin-tickets-list" id="admin-tickets-list">
                            <!-- لیست تیکت‌ها -->
                            <div class="empty-message">
                                <i class="fas fa-comments"></i>
                                <p>هیچ تیکتی ارسال نشده است</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تب کاربران -->
                <div class="tab-content" id="users-tab">
                    <div class="admin-section">
                        <h4>مدیریت کاربران</h4>
                        <div class="admin-users-list" id="admin-users-list">
                            <!-- لیست کاربران -->
                            <div class="empty-message">
                                <i class="fas fa-users"></i>
                                <p>هنوز کاربری ثبت نکرده‌اید</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
